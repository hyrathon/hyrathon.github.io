<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>Wideshears: Investigating and Breaking Widevine on QTEE | Hyrathon&#39;s Blog</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="é’ˆå¯¹QTEE&#43;Widevineçš„æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨
 æ‘˜è¦ ğŸ”—Widevine is a DRM solution, and QTEE is the TrustZone implement of Qualcomm, both running on billions of devices. In this presentation, we will share our latest study of Widevine on QTEE. We will first explain why QTEE and Widevine are high-value targets and share the basics about them in brief. After the opening, we will show how to locate the command handling logic and get the logic explained to show how we found a vulnerability.">
<meta name="generator" content="Hugo 0.88.1" />


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">



<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />







  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">â†</span>Home</a>
	
	<a href="/posts">Archive</a>
	<a href="/tags">Tags</a>
	<a href="/about">About</a>

	

	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">Wideshears: Investigating and Breaking Widevine on QTEE</h1>

    <div class="tip">
        <time datetime="2021-05-19 00:00:00 &#43;0000 UTC">May 19, 2021</time>
        <span class="split">
          Â·
        </span>
        <span>
          199 words
        </span>
        <span class="split">
          Â·
        </span>
        <span>
          1 minute read
        </span>
    </div>

    
    


    <div class="content">
      <blockquote>
<p>é’ˆå¯¹QTEE+Widevineçš„æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</p>
</blockquote>
<h2 id="æ‘˜è¦">æ‘˜è¦ <a href="#%e6%91%98%e8%a6%81" class="anchor">ğŸ”—</a></h2><p>Widevine is a DRM solution, and QTEE is the TrustZone implement of Qualcomm, both running on billions of devices. In this presentation, we will share our latest study of Widevine on QTEE. We will first explain why QTEE and Widevine are high-value targets and share the basics about them in brief. After the opening, we will show how to locate the command handling logic and get the logic explained to show how we found a vulnerability.</p>
<p>With the vulnerability in hand, we need the following in order to achieve the exploit:</p>
<ol>
<li>
<p>We need to know the memory model of a QTEE TA, especially how commands are delivered and how buffers are shared between the two worlds. Another vulnerability is put forward to do information leak with the model.</p>
</li>
<li>
<p>We need to know where the TA is loaded and find a way to break ASLR.</p>
</li>
<li>
<p>We need to find a memory layout to access TA from the user-controlled location.</p>
</li>
</ol>
<p>After the above is resolved, we will put them together to exploit the Widevine TA and extract data from SFS, the trusted storage of QTEE.</p>
<p>Prior knowledge is not mandatory but is recommended.</p>
<h2 id="é“¾æ¥">é“¾æ¥ <a href="#%e9%93%be%e6%8e%a5" class="anchor">ğŸ”—</a></h2><ul>
<li><a href="https://www.blackhat.com/asia-21/briefings/schedule/index.html#wideshears-investigating-and-breaking-widevine-on-qtee-21872" target="_blank" rel="noopener">https://www.blackhat.com/asia-21/briefings/schedule/index.html#wideshears-investigating-and-breaking-widevine-on-qtee-21872</a></li>
<li><a href="wideshears-slides.pdf">Slides</a></li>
<li><a href="wideshears-wp.pdf">Whitepaper</a></li>
<li><a href="https://www.youtube.com/embed/FMHshq5e3ck" target="_blank" rel="noopener">Video</a></li>
</ul>

    </div>

    
        <div class="tags">
            
                <a href="http://example.org/tags/untagged">untagged</a>
            
        </div>
    
    
    

</section>


    </main>
    
    <footer id="footer">
    

    <div class="copyright">
    
       Â© Copyright 
       2021 
       <span class="split">
        <svg fill="#bbbbbb" width="15" height="15" version="1.1" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">
  <path d="M13.91,6.75c-1.17,2.25-4.3,5.31-6.07,6.94c-0.1903,0.1718-0.4797,0.1718-0.67,0C5.39,12.06,2.26,9,1.09,6.75&#xA;&#x9;C-1.48,1.8,5-1.5,7.5,3.45C10-1.5,16.48,1.8,13.91,6.75z"/>
</svg>
       </span>
       
    
    </div>

    
      <div class="powerby">
        Powered by <a href='http://www.gohugo.io/'>Hugo</a> Theme By <a href='https://github.com/nodejh/hugo-theme-cactus-plus'>nodejh</a>
      </div>
    
</footer>



  </body>
</html>
